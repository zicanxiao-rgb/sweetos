<script>

/* æ—¶é—´ */
function updateTime(){
let n=new Date();
let h=String(n.getHours()).padStart(2,'0');
let m=String(n.getMinutes()).padStart(2,'0');
time.innerText=h+':'+m;
lockTime.innerText=h+':'+m;
}
setInterval(updateTime,1000);
updateTime();

/* è§£é” */
let startY=0;
lock.addEventListener("touchstart",e=>{startY=e.touches[0].clientY;});
lock.addEventListener("touchend",e=>{
if(startY-e.changedTouches[0].clientY>80){
lock.style.transform="translateY(-100%)";
home.style.transform="translateY(0)";
}
});

/* ç¿»é¡µ */
pages.addEventListener("scroll",()=>{
let idx=Math.round(pages.scrollLeft/pages.clientWidth);
document.querySelectorAll(".dot").forEach((d,i)=>{
d.classList.toggle("active",i===idx);
});
});

/* ä¸Šä¼ å‡½æ•° */
function bind(img,input){
img.onclick=()=>input.click();
input.onchange=e=>{
let reader=new FileReader();
reader.onload=ev=>img.src=ev.target.result;
reader.readAsDataURL(e.target.files[0]);
};
}

bind(mainAvatarImg,mainAvatarInput);
bind(idImg,idInput);
bind(s1,s1Input);
bind(s2,s2Input);
bind(s3,s3Input);
bind(me,meInput);
bind(ta,taInput);

bgArea.onclick=()=>bgInput.click();
bgInput.onchange=e=>{
let reader=new FileReader();
reader.onload=ev=>bgArea.style.backgroundImage=`url(${ev.target.result})`;
reader.readAsDataURL(e.target.files[0]);
};

/* æ‹çˆ±è®¡æ—¶ */
function updateLove(){
let d=new Date(loveDate.innerText);
let now=new Date();
let diff=Math.floor((now-d)/86400000);
loveDays.innerText=diff+" å¤©";
}
loveDate.oninput=updateLove;
setInterval(updateLove,60000);
updateLove();

/* ===== App ç‚¹å‡»åŠŸèƒ½ ===== */

const appScreen = document.getElementById("appScreen");
const appContent = document.getElementById("appContent");
const appTitle = document.getElementById("appTitle");
const backBtn = document.getElementById("backBtn");

document.querySelectorAll(".app").forEach(app=>{
  app.addEventListener("click",()=>{
    const name = app.innerText.trim();
    openApp(name);
  });
});

function openApp(name){
  appScreen.style.transform="translateX(0)";
  appTitle.innerText = name;

  if(name==="ç›¸å†Œ"){
    appContent.innerHTML="<h2>ğŸ“· æˆ‘çš„ç›¸å†Œ</h2><p>è¿™é‡Œå¯ä»¥æ”¾ç…§ç‰‡å†…å®¹</p>";
  }

  if(name==="æ—¥è®°"){
    appContent.innerHTML="<h2>ğŸ“” æ—¥è®°</h2><textarea style='width:100%;height:200px;'></textarea>";
  }

  if(name==="å¾®åš"){
    appContent.innerHTML="<h2>ğŸ“° åŠ¨æ€</h2><p>è¿™é‡Œæ˜¯å¾®åšæ—¶é—´çº¿</p>";
  }

  if(name==="å¤‡å¿˜å½•"){
    appContent.innerHTML="<h2>ğŸ“ å¤‡å¿˜å½•</h2><input placeholder='å†™ç‚¹ä»€ä¹ˆ...' style='width:100%;padding:10px;' />";
  }

  if(name==="å¾®ä¿¡"){
    appContent.innerHTML="<h2>ğŸ’¬ å¾®ä¿¡</h2><p>èŠå¤©ç•Œé¢</p>";
  }
}

backBtn.onclick=()=>{
  appScreen.style.transform="translateX(100%)";
};

</script>